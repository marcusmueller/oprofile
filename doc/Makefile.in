# $Id: Makefile.in,v 1.16 2002/04/04 02:16:52 phil_e Exp $

RM=rm
CP=cp
prefix=$(DESTDIR)@prefix@
MANDIR=@mandir@/man1
CATDIR=@mandir@/cat1
DOCDIR=$(prefix)/doc/oprofile-@VERSION@
LN_SF=ln -sf
MKDIR=mkdir
MKDIR_P=mkdir -p
XSLTPROC=xsltproc
# You can over-ride this with a locally installed docbook.xsl
# (see packages at http://docbook.sf.net)
STYLESHEET=http://docbook.sourceforge.net/release/xsl/current/xhtml/docbook.xsl
LINK_LIST=oprofiled.1 op_start.1 op_stop.1 op_help.1 oprofpp.1 op_time.1 op_to_source.1 op_merge.1

.PHONY: all clean install uninstall

all: oprofile.html

oprofile.html: oprofile.xml
	$(XSLTPROC) $(STYLESHEET) $< > $@

install: all
	-$(MKDIR_P) $(MANDIR)
	cp oprofile.1 $(MANDIR)/oprofile.1
	@for f in $(LINK_LIST); do				\
		$(RM) -f $(MANDIR)/$$f;				\
		echo ".so man1/oprofile.1" > $(MANDIR)/$$f;	\
	done
	@echo "Installing html doc in $(DOCDIR)"
	@$(MKDIR_P) $(DOCDIR)
	@cp -R *.html $(DOCDIR)

uninstall:
	rm -f $(MANDIR)/oprofile.1
	rm -f @mandir@/cat1/oprofile.1.gz
	@for f in $(LINK_LIST); do		\
		rm -f $(MANDIR)/$$f;		\
		rm -f $(CATDIR)/cat1/$$f.gz;	\
	done
	-$(RM) -rf $(DOCDIR)

clean:
