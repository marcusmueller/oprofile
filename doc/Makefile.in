# $Id: Makefile.in,v 1.12 2001/12/22 18:01:52 phil_e Exp $

RM=rm
CP=cp
prefix=$(DESTDIR)@prefix@
MANDIR=@mandir@/man1
CATDIR=@mandir@/cat1
DOCDIR=$(prefix)/doc/oprofile-@VERSION@
LN_SF=ln -sf
MKDIR=mkdir
MKDIR_P=mkdir -p
DB2HTML=db2html
LINK_LIST=oprofiled.1 op_start.1 op_stop.1 op_help.1 oprofpp.1

.PHONY: all clean install uninstall

all: html/install.html

html/install.html: oprofile.sgml
	-$(RM) -rf oprofile.junk
	-$(DB2HTML) oprofile.sgml
	-$(MKDIR) html
	-$(MKDIR) html/stylesheet-images/ 
	-mv oprofile/* html/
	-mv oprofile/stylesheet-images/* html/stylesheet-images/
	-$(RM) -rf oprofile 

install: all
	-$(MKDIR_P) $(MANDIR)
	cp oprofile.1 $(MANDIR)/oprofile.1
	@for f in $(LINK_LIST); do				\
		$(RM) -f $(MANDIR)/$$f;				\
		echo ".so man1/oprofile.1" > $(MANDIR)/$$f;	\
	done
	@echo "Installing html doc in $(DOCDIR)"
	@$(MKDIR_P) $(DOCDIR)
	@cp -R html/* $(DOCDIR)

uninstall:
	rm -f $(MANDIR)/oprofile.1
	rm -f @mandir@/cat1/oprofile.1.gz
	@for f in $(LINK_LIST); do		\
		rm -f $(MANDIR)/$$f;		\
		rm -f $(CATDIR)/cat1/$$f.gz;	\
	done
	-$(RM) -rf $(DOCDIR)

clean:
